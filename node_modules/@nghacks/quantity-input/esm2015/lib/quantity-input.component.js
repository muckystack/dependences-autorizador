import { Component, EventEmitter, forwardRef, Input, Output } from '@angular/core';
import { FormControl, NG_VALUE_ACCESSOR } from '@angular/forms';
import { Subject } from 'rxjs';
import { takeUntil } from 'rxjs/operators';
export class QuantityInputComponent {
    constructor() {
        this.quantityCtrl = new FormControl(1);
        this.limit = 10000000;
        // Allow the input to be disabled, and when it is make it somewhat transparent.
        this.disabled = false;
        this._unsubscribeAll = new Subject();
        this.quantityChange = new EventEmitter();
        // Function to call when the quantity changes.
        this.onChange = (quantity) => {
            this.quantityChange.emit(quantity);
        };
        // Function to call when the input is touched (when a star is clicked).
        this.onTouched = () => { };
        this.quantityCtrl.valueChanges
            .pipe(takeUntil(this._unsubscribeAll))
            .subscribe((val) => {
            if (this.quantityCtrl.value < 1) {
                this.writeValue(1);
            }
            else if (this.quantityCtrl.value > this.limit) {
                this.writeValue(this.limit);
            }
            else {
                this.writeValue(this.quantityCtrl.value);
            }
        });
    }
    set limitValue(v) {
        if (!v) {
            return;
        }
        this.limit = parseInt(v);
    }
    set disabledValue(v) {
        if (!v) {
            return;
        }
        this.quantityCtrl.disable();
        this.disabled = v;
    }
    get value() {
        return this.quantityCtrl.value;
    }
    increase() {
        if (!this.disabled) {
            this.quantityCtrl.setValue((this.quantityCtrl.value + 1));
        }
    }
    decrease() {
        if (!this.disabled) {
            this.quantityCtrl.setValue((this.quantityCtrl.value - 1));
        }
    }
    // Allows Angular to update the model (quantity).
    // Update the model and changes needed for the view here.
    writeValue(quantity) {
        this.quantityCtrl.setValue(quantity, { emitEvent: false });
        this.onChange(this.value);
    }
    // Allows Angular to register a function to call when the model (quantity) changes.
    // Save the function as a property to call later here.
    registerOnChange(fn) {
        this.onChange = fn;
    }
    // Allows Angular to register a function to call when the input has been touched.
    // Save the function as a property to call later here.
    registerOnTouched(fn) {
        this.onTouched = fn;
    }
    // Allows Angular to disable the input.
    setDisabledState(isDisabled) {
        this.disabled = isDisabled;
        if (isDisabled) {
            this.quantityCtrl.disable();
        }
        else {
            this.quantityCtrl.enable();
        }
    }
    ngOnDestroy() {
        this._unsubscribeAll.next();
        this._unsubscribeAll.complete();
    }
}
QuantityInputComponent.decorators = [
    { type: Component, args: [{
                selector: 'quantity-input',
                template: "<div class=\"nghacks-quantity-input-container\">\n\n  <button (click)=\"decrease()\" mat-raised-button [color]=\"color\" [disabled]=\"disabled || quantityCtrl.value === 1\">\n    <mat-icon>remove</mat-icon>\n  </button>\n\n  <input [style.borderColor]=\"disabled ? '#e0e0e0' : '#212121'\" [formControl]=\"quantityCtrl\" #queantityInputElem type=\"number\" min=\"1\" max=\"10\">\n\n  <button (click)=\"increase()\" mat-raised-button [color]=\"color\" [disabled]=\"disabled || quantityCtrl.value === limit\">\n    <mat-icon>add</mat-icon>\n  </button>\n\n</div>\n",
                providers: [
                    {
                        provide: NG_VALUE_ACCESSOR,
                        useExisting: forwardRef(() => QuantityInputComponent),
                        multi: true
                    }
                ],
                styles: [".nghacks-quantity-input-container{align-items:center;display:inline-flex;justify-content:center}.nghacks-quantity-input-container button{border-radius:50%;min-width:0;padding:0;width:36px}.nghacks-quantity-input-container input{background:transparent;border:none;border-bottom:1px solid;box-sizing:border-box;height:36px;margin:0 5px;outline:none;text-align:center;width:40px}.nghacks-quantity-input-container input::-webkit-inner-spin-button,.nghacks-quantity-input-container input::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.nghacks-quantity-input-container input[type=number]{-moz-appearance:textfield}"]
            },] }
];
QuantityInputComponent.ctorParameters = () => [];
QuantityInputComponent.propDecorators = {
    color: [{ type: Input }],
    limitValue: [{ type: Input, args: ['limit',] }],
    disabledValue: [{ type: Input, args: ['disabled',] }],
    quantityChange: [{ type: Output }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicXVhbnRpdHktaW5wdXQuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vcHJvamVjdHMvcXVhbnRpdHktaW5wdXQvc3JjL2xpYi9xdWFudGl0eS1pbnB1dC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxZQUFZLEVBQUUsVUFBVSxFQUFFLEtBQUssRUFBYSxNQUFNLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDOUYsT0FBTyxFQUF3QixXQUFXLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUN0RixPQUFPLEVBQUUsT0FBTyxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQy9CLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQWMzQyxNQUFNLE9BQU8sc0JBQXNCO0lBcUNqQztRQW5DQSxpQkFBWSxHQUFHLElBQUksV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBSWxDLFVBQUssR0FBRyxRQUFRLENBQUM7UUFPakIsK0VBQStFO1FBQy9FLGFBQVEsR0FBRyxLQUFLLENBQUM7UUFRVCxvQkFBZSxHQUFpQixJQUFJLE9BQU8sRUFBRSxDQUFDO1FBRTVDLG1CQUFjLEdBQUcsSUFBSSxZQUFZLEVBQVUsQ0FBQztRQUV0RCw4Q0FBOEM7UUFDOUMsYUFBUSxHQUFHLENBQUMsUUFBZ0IsRUFBRSxFQUFFO1lBQzlCLElBQUksQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ3JDLENBQUMsQ0FBQTtRQUVELHVFQUF1RTtRQUN2RSxjQUFTLEdBQUcsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDO1FBTXBCLElBQUksQ0FBQyxZQUFZLENBQUMsWUFBWTthQUMzQixJQUFJLENBQ0gsU0FBUyxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsQ0FDaEM7YUFDQSxTQUFTLENBQUMsQ0FBQyxHQUFHLEVBQUUsRUFBRTtZ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QyxzQkFBc0IsQ0FBQzt3QkFDckQsS0FBSyxFQUFFLElBQUk7cUJBQ1o7aUJBQ0Y7O2FBQ0Y7Ozs7b0JBS0UsS0FBSzt5QkFHTCxLQUFLLFNBQUMsT0FBTzs0QkFRYixLQUFLLFNBQUMsVUFBVTs2QkFTaEIsTUFBTSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgRXZlbnRFbWl0dGVyLCBmb3J3YXJkUmVmLCBJbnB1dCwgT25EZXN0cm95LCBPdXRwdXQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IENvbnRyb2xWYWx1ZUFjY2Vzc29yLCBGb3JtQ29udHJvbCwgTkdfVkFMVUVfQUNDRVNTT1IgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5pbXBvcnQgeyBTdWJqZWN0IH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyB0YWtlVW50aWwgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ3F1YW50aXR5LWlucHV0JyxcbiAgdGVtcGxhdGVVcmw6ICcuL3F1YW50aXR5LWlucHV0LmNvbXBvbmVudC5odG1sJyxcbiAgc3R5bGVVcmxzOiBbJy4vcXVhbnRpdHktaW5wdXQuY29tcG9uZW50LnNjc3MnXSxcbiAgcHJvdmlkZXJzOiBbXG4gICAge1xuICAgICAgcHJvdmlkZTogTkdfVkFMVUVfQUNDRVNTT1IsXG4gICAgICB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBRdWFudGl0eUlucHV0Q29tcG9uZW50KSxcbiAgICAgIG11bHRpOiB0cnVlXG4gICAgfVxuICBdXG59KVxuZXhwb3J0IGNsYXNzIFF1YW50aXR5SW5wdXRDb21wb25lbnQgaW1wbGVtZW50cyBDb250cm9sVmFsdWVBY2Nlc3NvciwgT25EZXN0cm95IHtcblxuICBxdWFudGl0eUN0cmwgPSBuZXcgRm9ybUNvbnRyb2woMSk7XG5cbiAgQElucHV0KCkgY29sb3I6IHN0cmluZztcblxuICBsaW1pdCA9IDEwMDAwMDAwO1xuICBASW5wdXQoJ2xpbWl0JylcbiAgcHJpdmF0ZSBzZXQgbGltaXRWYWx1ZSh2OiBzdHJpbmcpIHtcbiAgICBpZiAoIXYpIHsgcmV0dXJuOyB9XG4gICAgdGhpcy5saW1pdCA9IHBhcnNlSW50KHYpO1xuICB9XG5cbiAgLy8gQWxsb3cgdGhlIGlucHV0IHRvIGJlIGRpc2FibGVkLCBhbmQgd2hlbiBpdCBpcyBtYWtlIGl0IHNvbWV3aGF0IHRyYW5zcGFyZW50LlxuICBkaXNhYmxlZCA9IGZhbHNlO1xuICBASW5wdXQoJ2Rpc2FibGVkJylcbiAgcHJpdmF0ZSBzZXQgZGlzYWJsZWRWYWx1ZSh2OiBib29sZWFuKSB7XG4gICAgaWYgKCF2KSB7IHJldHVybjsgfVxuICAgIHRoaXMucXVhbnRpdHlDdHJsLmRpc2FibGUoKTtcbiAgICB0aGlzLmRpc2FibGVkID0gdjtcbiAgfVxuXG4gIHByaXZhdGUgX3Vuc3Vic2NyaWJlQWxsOiBTdWJqZWN0PGFueT4gPSBuZXcgU3ViamVjdCgpO1xuXG4gIEBPdXRwdXQoKSBxdWFudGl0eUNoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXI8bnVtYmVyPigpO1xuXG4gIC8vIEZ1bmN0aW9uIHRvIGNhbGwgd2hlbiB0aGUgcXVhbnRpdHkgY2hhbmdlcy5cbiAgb25DaGFuZ2UgPSAocXVhbnRpdHk6IG51bWJlcikgPT4ge1xuICAgIHRoaXMucXVhbnRpdHlDaGFuZ2UuZW1pdChxdWFudGl0eSk7XG4gIH1cblxuICAvLyBGdW5jdGlvbiB0byBjYWxsIHdoZW4gdGhlIGlucHV0IGlzIHRvdWNoZWQgKHdoZW4gYSBzdGFyIGlzIGNsaWNrZWQpLlxuICBvblRvdWNoZWQgPSAoKSA9PiB7IH07XG4gIGdldCB2YWx1ZSgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLnF1YW50aXR5Q3RybC52YWx1ZTtcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMucXVhbnRpdHlDdHJsLnZhbHVlQ2hhbmdlc1xuICAgICAgLnBpcGUoXG4gICAgICAgIHRha2VVbnRpbCh0aGlzLl91bnN1YnNjcmliZUFsbClcbiAgICAgIClcbiAgICAgIC5zdWJzY3JpYmUoKHZhbCkgPT4ge1xuICAgICAgICBpZiAodGhpcy5xdWFudGl0eUN0cmwudmFsdWUgPCAxKSB7XG4gICAgICAgICAgdGhpcy53cml0ZVZhbHVlKDEpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMucXVhbnRpdHlDdHJsLnZhbHVlID4gdGhpcy5saW1pdCkge1xuICAgICAgICAgIHRoaXMud3JpdGVWYWx1ZSh0aGlzLmxpbWl0KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICB0aGlzLndyaXRlVmFsdWUodGhpcy5xdWFudGl0eUN0cmwudmFsdWUpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgfVxuXG4gIGluY3JlYXNlKCk6IHZvaWQge1xuICAgIGlmICghdGhpcy5kaXNhYmxlZCkge1xuICAgICAgdGhpcy5xdWFudGl0eUN0cmwuc2V0VmFsdWUoKHRoaXMucXVhbnRpdHlDdHJsLnZhbHVlICsgMSkpO1xuICAgIH1cbiAgfVxuXG4gIGRlY3JlYXNlKCk6IHZvaWQge1xuICAgIGlmICghdGhpcy5kaXNhYmxlZCkge1xuICAgICAgdGhpcy5xdWFudGl0eUN0cmwuc2V0VmFsdWUoKHRoaXMucXVhbnRpdHlDdHJsLnZhbHVlIC0gMSkpO1xuICAgIH1cbiAgfVxuXG4gIC8vIEFsbG93cyBBbmd1bGFyIHRvIHVwZGF0ZSB0aGUgbW9kZWwgKHF1YW50aXR5KS5cbiAgLy8gVXBkYXRlIHRoZSBtb2RlbCBhbmQgY2hhbmdlcyBuZWVkZWQgZm9yIHRoZSB2aWV3IGhlcmUuXG4gIHdyaXRlVmFsdWUocXVhbnRpdHk6IG51bWJlcik6IHZvaWQge1xuICAgIHRoaXMucXVhbnRpdHlDdHJsLnNldFZhbHVlKHF1YW50aXR5LCB7IGVtaXRFdmVudDogZmFsc2UgfSk7XG4gICAgdGhpcy5vbkNoYW5nZSh0aGlzLnZhbHVlKTtcbiAgfVxuXG4gIC8vIEFsbG93cyBBbmd1bGFyIHRvIHJlZ2lzdGVyIGEgZnVuY3Rpb24gdG8gY2FsbCB3aGVuIHRoZSBtb2RlbCAocXVhbnRpdHkpIGNoYW5nZXMuXG4gIC8vIFNhdmUgdGhlIGZ1bmN0aW9uIGFzIGEgcHJvcGVydHkgdG8gY2FsbCBsYXRlciBoZXJlLlxuICByZWdpc3Rlck9uQ2hhbmdlKGZuOiAocXVhbnRpdHk6IG51bWJlcikgPT4gdm9pZCk6IHZvaWQge1xuICAgIHRoaXMub25DaGFuZ2UgPSBmbjtcbiAgfVxuXG4gIC8vIEFsbG93cyBBbmd1bGFyIHRvIHJlZ2lzdGVyIGEgZnVuY3Rpb24gdG8gY2FsbCB3aGVuIHRoZSBpbnB1dCBoYXMgYmVlbiB0b3VjaGVkLlxuICAvLyBTYXZlIHRoZSBmdW5jdGlvbiBhcyBhIHByb3BlcnR5IHRvIGNhbGwgbGF0ZXIgaGVyZS5cbiAgcmVnaXN0ZXJPblRvdWNoZWQoZm46ICgpID0+IHZvaWQpOiB2b2lkIHtcbiAgICB0aGlzLm9uVG91Y2hlZCA9IGZuO1xuICB9XG5cbiAgLy8gQWxsb3dzIEFuZ3VsYXIgdG8gZGlzYWJsZSB0aGUgaW5wdXQuXG4gIHNldERpc2FibGVkU3RhdGUoaXNEaXNhYmxlZDogYm9vbGVhbik6IHZvaWQge1xuICAgIHRoaXMuZGlzYWJsZWQgPSBpc0Rpc2FibGVkO1xuICAgIGlmIChpc0Rpc2FibGVkKSB7XG4gICAgICB0aGlzLnF1YW50aXR5Q3RybC5kaXNhYmxlKCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgdGhpcy5xdWFudGl0eUN0cmwuZW5hYmxlKCk7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIG5nT25EZXN0cm95KCk6IHZvaWQge1xuICAgIHRoaXMuX3Vuc3Vic2NyaWJlQWxsLm5leHQoKTtcbiAgICB0aGlzLl91bnN1YnNjcmliZUFsbC5jb21wbGV0ZSgpO1xuICB9XG5cbn1cbiJdfQ==